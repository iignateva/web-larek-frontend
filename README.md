# Проектная работа "Веб-ларек"

Стек: HTML, SCSS, TS, Webpack

Структура проекта:
- src/ — исходные файлы проекта
- src/components/ — папка с JS компонентами
- src/components/base/ — папка с базовым кодом

Важные файлы:
- src/pages/index.html — HTML-файл главной страницы
- src/types/index.ts — файл с типами
- src/index.ts — точка входа приложения
- src/scss/styles.scss — корневой файл стилей
- src/utils/constants.ts — файл с константами
- src/utils/utils.ts — файл с утилитами

## Установка и запуск
Для установки и запуска проекта необходимо выполнить команды

```
npm install
npm run start
```

или

```
yarn
yarn start
```
## Сборка

```
npm run build
```

или

```
yarn build
```

## Базовый код

### класс WebLarek
Класс для работы с сервером. Реализует интерфейс WebLarekApi. Основные методы: 
 - getProducts() - возвращает все доступные продукты
 - getProduct(id) - возвращает данные по указанному id продукта
 - confirmOrder(order) - создает заказ, возвращает id заказа или ошибку

### класс EventEmitter 
Брокер событий, используется для создания событий, подписки на события, и удаления подписки.
Методы: 
 - on(eventName, callback) - для подписки на указанное событие
 - off(eventName, callback) - удаление подписки на указанное событие
 - emit(eventName, data?) — создание события
Также можно подписать всех слушателей на событие, используя метод ```onAll``` и отписать всех от события, используя ```offAll```.
Метод ```trigger``` может использоваться как callback в классах, не зависящих от EventEmitter, для создания события с заданными
аргументами.

### класс Component 
Общий класс для всех компонентов ui. Реализована базовые действия над компонентами: 
 - toggleClass(element: HTMLElement, className: string, force?: boolean) - переключение css-класса на элементе
 - setText(element: HTMLElement, value: unknown) - установить новый текст на элементе
 - setDisabled(element: HTMLElement, state: boolean) - сменить значение disable-аттрибута на элементе
 - setHidden(element: HTMLElement) - скрыть элемент
 - setVisible(element: HTMLElement) - показать элемент
 - setImage(element: HTMLImageElement, src: string, alt?: string) - установить изображение
 - isValid(errorElement: HTMLElement, ...elements: HTMLElement[]) - проверяет переданные в elements элементы типа HTMLInputElement на обязательность заполнения. Если есть незаполненные, то отображается errorElement и в него помещается текст ошибки.

 ### класс Model
 Общий класс для классов Model-слоя


### 1. Компоненты модели данных (бизнес-логика)

1.1 Класс ```Order```, предназначен для создания заказа. Содержит данные:
 - ```total``` - общая стоимость заказа  
 - ```items``` - список товаров 
 - ```address``` - адрес
 - ```paymentType``` - форма оплаты
 - ```phone``` - телефон
 - ```email``` - email   

1.2 Класс ```ShoppingCart```- корзина для формирования списка продуктов, которые может заказать пользователь.
В корзину можно добавлять продукты и удалять их используя методы ```addItem(product)``` и ```deleteItem``` соответственно.
```totalCount()``` - получить количество продуктов в корзине
```total``` - общая стоимость продуктов корзины
```items``` - список продуктов IProduct

1.3 Класс ```AppState``` - состояние приложения. Включает в себя:
  - products: IItems<IProduct> - список товаров
	- shoppingCart: ShoppingCart - корзина
	- order: Order - заказываемый товар. 
При успешном завершении заказа товары удаляются из корзины и заказ обновляется на новый

### 2. Компоненты отображения (ui)

2.1 ```Page```
Класс страницы. Свойства: 
 ```locked``` позволяет поставить блокировку на пролистывание страницы при открытых модальных окнах.
 ```catalog``` принимает массив HTMLElement для добавления их на страницу

2.2 ```Header```
Класс для отображения шапки страницы. Динамически меняется 1 элемент: счетчик товаров в корзине.
	shoppingCartItemCounter - счетчик товаров в корзине
При нажатии на кнопку корзины отправляется событие ```EVENT.ShoppingCartOpening``` 

2.3 ```CatalogItem```
  Родительский класс для отображения товара в каталоге на основной странице Page ```CatalogItemView``` и для модального окна с полной информацией о товаре ```CatalogItemPreview```.

2.4 ```CatalogItemView```
  Класс для отображения товара в каталоге на основной странице Page. При клике на карточку отправляется событие EVENT.CatalogItemPreviewOpening, чтобы открыть модальное окно с полной информацией о товаре (класс ```CatalogItemPreview```)

2.5 ```CatalogItemPreview```
  Класс для отображения в модальном окне полной информации о товаре. При открытии модального окна проверяется наличие товара в корзине и передается в карточку true/false в свойство ```inShoppingCart```. В зависимости от состояния свойства ```inShoppingCart``` меняется текст и обработчик клика на кнопке в модальном окне: 
   - true: текст кнопки "Удалить из корзины", обработчик - удаление товара из корзины
   - false: текст кнопки "В корзину", обработчик - добавление в корзину

2.6 ```ShoppingCartView```
Класс для отображения корзины. Содержит в себе список продуктов, общее количество товаров и общую сумму заказа

2.7 ```OrderView```
Класс для отображения данных доставки заказа: адрес и тип оплаты. Поле адреса обязательно для заполнения. Кнопка отправки доступна только при заполненном адресе и выборе одного из типов оплаты

2.8 ```ContactsView```
Класс для отображения контактов в заказе. Оба поля обязательны: email, phone

2.9 ```SuccessOrderView```
Класс для отображения успешного формирования заказа. Отображает id заказа и сумму списания.